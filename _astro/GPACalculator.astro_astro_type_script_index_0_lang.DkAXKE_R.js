document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("courses-container"),u=document.getElementById("add-course"),B=document.getElementById("calculate"),r=document.getElementById("clear-all"),m=document.getElementById("save-data"),E=document.getElementById("results"),b=document.getElementById("cgpa-result");let w=1;const h=50,p=()=>{const e=s?.querySelectorAll(".course-row"),t=s?.querySelectorAll(".remove-btn");if(e&&t){const n=e.length<=1;if(t.forEach(o=>{o.disabled=n}),u){const o=e.length>=h;u.disabled=o,u.title=o?"Maximum courses reached":""}}},L=localStorage.getItem("iium-gpa-data");if(L)try{const e=JSON.parse(L);e.prevCgpa&&(document.getElementById("prev-cgpa").value=e.prevCgpa),e.prevCredits&&(document.getElementById("prev-credits").value=e.prevCredits)}catch{}p(),s?.addEventListener("keydown",e=>{if(e.key==="Enter"){const t=e.target,n=t.closest(".course-row");n&&(t.tagName==="INPUT"||t.tagName==="SELECT")&&(e.preventDefault(),n.nextElementSibling?n.nextElementSibling.querySelector(".course-name")?.focus():u.disabled||u?.click())}}),u?.addEventListener("click",()=>{if((s?.querySelectorAll(".course-row").length||0)>=h)return;const t=document.createElement("div");t.className="course-row slide-in",t.dataset.index=w++,t.innerHTML=`
        <input type="text" class="course-name" placeholder="Course name" aria-label="Course name" maxlength="60" />
        <select class="grade" aria-label="Grade">
          <option value="">Grade</option>
          <option value="4.00">A (4.00)</option>
          <option value="3.67">A- (3.67)</option>
          <option value="3.33">B+ (3.33)</option>
          <option value="3.00">B (3.00)</option>
          <option value="2.67">B- (2.67)</option>
          <option value="2.33">C+ (2.33)</option>
          <option value="2.00">C (2.00)</option>
          <option value="1.67">C- (1.67)</option>
          <option value="1.33">D+ (1.33)</option>
          <option value="1.00">D (1.00)</option>
          <option value="0.00">F (0.00)</option>
        </select>
        <select class="credits" aria-label="Credits">
          <option value="">Credits</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>
        <button type="button" class="remove-btn" title="Remove course" aria-label="Remove course">×</button>
      `,s?.appendChild(t),p(),t.querySelector(".course-name")?.focus()}),s?.addEventListener("click",e=>{const t=e.target.closest(".remove-btn");if(t&&Array.from(s.querySelectorAll(".course-row")).length>1){const o=t.closest(".course-row");if(!o)return;const a=()=>{let l=o.nextElementSibling?.querySelector(".remove-btn");l||(l=o.previousElementSibling?.querySelector(".remove-btn")),o.remove(),l&&l.focus(),p()};window.matchMedia("(prefers-reduced-motion: reduce)").matches?a():(o.classList.add("removing"),setTimeout(a,200))}}),s?.addEventListener("input",e=>{const t=e.target;t.classList.contains("input-error")&&(t.classList.remove("input-error"),t.removeAttribute("aria-invalid")),document.getElementById("validation-error")?.classList.remove("visible")}),B?.addEventListener("click",()=>{const e=s?.querySelectorAll(".course-row"),t=document.getElementById("validation-error");t&&(t.textContent="",t.classList.remove("visible"));let n=!1,o=0,a=0;if(e?.forEach(i=>{const f=i.querySelector(".course-name"),c=i.querySelector(".grade"),d=i.querySelector(".credits");[f,c,d].forEach(v=>{v?.classList.remove("input-error"),v?.removeAttribute("aria-invalid")});const A=f.value.trim()!=="",y=c.value!=="",C=d.value!=="";if((A||y||C)&&(!y||!C))n=!0,y||(c.classList.add("input-error"),c.setAttribute("aria-invalid","true")),C||(d.classList.add("input-error"),d.setAttribute("aria-invalid","true"));else if(y&&C){const v=parseFloat(c.value),x=parseInt(d.value);!isNaN(v)&&!isNaN(x)&&(o+=v*x,a+=x)}}),n){t&&(t.textContent="⚠️ Please fill in Grade and Credits for all started courses.",t.classList.add("visible")),E?.classList.add("hidden"),b?.classList.add("hidden");const i=s?.querySelector(".input-error");i&&(i.focus(),i.scrollIntoView({behavior:"smooth",block:"center"}));return}const I=a>0?(o/a).toFixed(2):"0.00";document.getElementById("semester-gpa").textContent=I,document.getElementById("total-credits").textContent=a,E?.classList.remove("hidden");const l=parseFloat(document.getElementById("prev-cgpa").value),g=parseInt(document.getElementById("prev-credits").value);if(!isNaN(l)&&!isNaN(g)&&g>0){const f=l*g+o,c=g+a,d=(f/c).toFixed(2);document.getElementById("new-cgpa").textContent=d,b?.classList.remove("hidden")}});let S;r?.addEventListener("click",()=>{if(r.getAttribute("data-confirm")==="true")s?.querySelectorAll(".course-row")?.forEach((t,n)=>{n>0?t.remove():(t.querySelector(".course-name").value="",t.querySelector(".grade").value="",t.querySelector(".credits").value="",t.querySelector(".course-name").focus())}),document.getElementById("prev-cgpa").value="",document.getElementById("prev-credits").value="",E?.classList.add("hidden"),b?.classList.add("hidden"),p(),r.textContent="Clear All",r.classList.remove("btn-danger-text"),r.removeAttribute("data-confirm"),clearTimeout(S);else{const e=r.textContent;r.textContent="Confirm Clear?",r.classList.add("btn-danger-text"),r.setAttribute("data-confirm","true"),S=setTimeout(()=>{r.textContent=e,r.classList.remove("btn-danger-text"),r.removeAttribute("data-confirm")},3e3)}}),m?.addEventListener("click",()=>{const e=document.getElementById("prev-cgpa"),t=document.getElementById("prev-credits"),n=document.getElementById("save-status"),o={prevCgpa:e?.value||"",prevCredits:t?.value||""};localStorage.setItem("iium-gpa-data",JSON.stringify(o));const a=m.textContent;m.textContent="✅ Saved!",m.disabled=!0,n&&(n.textContent="Changes saved successfully",n.classList.add("visible")),setTimeout(()=>{m.textContent=a,m.disabled=!1,n&&(n.classList.remove("visible"),setTimeout(()=>{n.textContent=""},300))},2e3)}),document.querySelectorAll(".copy-btn").forEach(e=>{e.addEventListener("click",async()=>{const n=e.previousElementSibling?.textContent||"";try{await navigator.clipboard.writeText(n);const o=e.innerHTML;e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>',e.classList.add("copied"),e.setAttribute("aria-label","Copied!"),setTimeout(()=>{e.innerHTML=o,e.classList.remove("copied"),e.setAttribute("aria-label","Copy to clipboard")},2e3)}catch(o){console.error("Failed to copy:",o)}})})});
//# sourceMappingURL=GPACalculator.astro_astro_type_script_index_0_lang.DkAXKE_R.js.map
