document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("courses-container"),m=document.getElementById("add-course"),I=document.getElementById("calculate"),i=document.getElementById("clear-all"),v=document.getElementById("save-data"),E=document.getElementById("results"),b=document.getElementById("cgpa-result");let w=1;const x=50,g=()=>{if(m&&r){const t=r.children.length>=x;m.disabled=t,m.title=t?"Maximum courses reached":""}},L=localStorage.getItem("iium-gpa-data");if(L)try{const e=JSON.parse(L);e.prevCgpa&&(document.getElementById("prev-cgpa").value=e.prevCgpa),e.prevCredits&&(document.getElementById("prev-credits").value=e.prevCredits)}catch{}if(g(),r&&r.children.length===1){const e=r.querySelector(".remove-btn");e&&(e.disabled=!0)}r?.addEventListener("keydown",e=>{if(e.key==="Enter"){const t=e.target,o=t.closest(".course-row");o&&(t.tagName==="INPUT"||t.tagName==="SELECT")&&(e.preventDefault(),o.nextElementSibling?o.nextElementSibling.querySelector(".course-name")?.focus():m.disabled||m?.click())}}),m?.addEventListener("click",()=>{const e=r?.children.length||0;if(e>=x)return;if(e===1){const o=r?.firstElementChild?.querySelector(".remove-btn");o&&(o.disabled=!1)}const t=document.createElement("div");t.className="course-row slide-in",t.dataset.index=w++,t.innerHTML=`
        <input type="text" class="course-name" placeholder="Course name" aria-label="Course name" maxlength="60" />
        <select class="grade" aria-label="Grade">
          <option value="">Grade</option>
          <option value="4.00">A (4.00)</option>
          <option value="3.67">A- (3.67)</option>
          <option value="3.33">B+ (3.33)</option>
          <option value="3.00">B (3.00)</option>
          <option value="2.67">B- (2.67)</option>
          <option value="2.33">C+ (2.33)</option>
          <option value="2.00">C (2.00)</option>
          <option value="1.67">C- (1.67)</option>
          <option value="1.33">D+ (1.33)</option>
          <option value="1.00">D (1.00)</option>
          <option value="0.00">F (0.00)</option>
        </select>
        <select class="credits" aria-label="Credits">
          <option value="">Credits</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>
        <button type="button" class="remove-btn" title="Remove course" aria-label="Remove course">×</button>
      `,r?.appendChild(t),g(),t.querySelector(".course-name")?.focus()}),r?.addEventListener("click",e=>{const t=e.target.closest(".remove-btn");if(t&&(r?.children.length||0)>1){const n=t.closest(".course-row");if(!n)return;const s=()=>{let l=n.nextElementSibling?.querySelector(".remove-btn");if(l||(l=n.previousElementSibling?.querySelector(".remove-btn")),n.remove(),r?.children.length===1){const c=r.firstElementChild?.querySelector(".remove-btn");c&&(c.disabled=!0)}l&&l.focus(),g()};window.matchMedia("(prefers-reduced-motion: reduce)").matches?s():(n.classList.add("removing"),setTimeout(s,200))}}),r?.addEventListener("input",e=>{const t=e.target;t.classList.contains("input-error")&&(t.classList.remove("input-error"),t.removeAttribute("aria-invalid")),document.getElementById("validation-error")?.classList.remove("visible")}),I?.addEventListener("click",()=>{const e=r?.children,t=document.getElementById("validation-error");t&&(t.textContent="",t.classList.remove("visible"));let o=!1,n=0,s=0;if(Array.from(e||[]).forEach(a=>{const f=a.querySelector(".course-name"),d=a.querySelector(".grade"),u=a.querySelector(".credits");[f,d,u].forEach(p=>{p?.classList.remove("input-error"),p?.removeAttribute("aria-invalid")});const A=f.value.trim()!=="",y=d.value!=="",C=u.value!=="";if((A||y||C)&&(!y||!C))o=!0,y||(d.classList.add("input-error"),d.setAttribute("aria-invalid","true")),C||(u.classList.add("input-error"),u.setAttribute("aria-invalid","true"));else if(y&&C){const p=parseFloat(d.value),h=parseInt(u.value);!isNaN(p)&&!isNaN(h)&&(n+=p*h,s+=h)}}),o){t&&(t.textContent="⚠️ Please fill in Grade and Credits for all started courses.",t.classList.add("visible")),E?.classList.add("hidden"),b?.classList.add("hidden");const a=r?.querySelector(".input-error");a&&(a.focus(),a.scrollIntoView({behavior:"smooth",block:"center"}));return}const B=s>0?(n/s).toFixed(2):"0.00";document.getElementById("semester-gpa").textContent=B,document.getElementById("total-credits").textContent=s,E?.classList.remove("hidden");const l=parseFloat(document.getElementById("prev-cgpa").value),c=parseInt(document.getElementById("prev-credits").value);if(!isNaN(l)&&!isNaN(c)&&c>0){const f=l*c+n,d=c+s,u=(f/d).toFixed(2);document.getElementById("new-cgpa").textContent=u,b?.classList.remove("hidden")}});let S;i?.addEventListener("click",()=>{if(i.getAttribute("data-confirm")==="true"){const e=r?.children;e&&Array.from(e).forEach((t,o)=>{if(o>0)t.remove();else{t.querySelector(".course-name").value="",t.querySelector(".grade").value="",t.querySelector(".credits").value="",t.querySelector(".course-name").focus();const n=t.querySelector(".remove-btn");n&&(n.disabled=!0)}}),document.getElementById("prev-cgpa").value="",document.getElementById("prev-credits").value="",E?.classList.add("hidden"),b?.classList.add("hidden"),g(),i.textContent="Clear All",i.classList.remove("btn-danger-text"),i.removeAttribute("data-confirm"),clearTimeout(S)}else{const e=i.textContent;i.textContent="Confirm Clear?",i.classList.add("btn-danger-text"),i.setAttribute("data-confirm","true"),S=setTimeout(()=>{i.textContent=e,i.classList.remove("btn-danger-text"),i.removeAttribute("data-confirm")},3e3)}}),v?.addEventListener("click",()=>{const e=document.getElementById("prev-cgpa"),t=document.getElementById("prev-credits"),o=document.getElementById("save-status"),n={prevCgpa:e?.value||"",prevCredits:t?.value||""};localStorage.setItem("iium-gpa-data",JSON.stringify(n));const s=v.textContent;v.textContent="✅ Saved!",v.disabled=!0,o&&(o.textContent="Changes saved successfully",o.classList.add("visible")),setTimeout(()=>{v.textContent=s,v.disabled=!1,o&&(o.classList.remove("visible"),setTimeout(()=>{o.textContent=""},300))},2e3)}),document.querySelectorAll(".copy-btn").forEach(e=>{e.addEventListener("click",async()=>{const o=e.previousElementSibling?.textContent||"";try{await navigator.clipboard.writeText(o);const n=e.innerHTML;e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>',e.classList.add("copied"),e.setAttribute("aria-label","Copied!"),setTimeout(()=>{e.innerHTML=n,e.classList.remove("copied"),e.setAttribute("aria-label","Copy to clipboard")},2e3)}catch(n){console.error("Failed to copy:",n)}})})});
//# sourceMappingURL=GPACalculator.astro_astro_type_script_index_0_lang.BZhX_suP.js.map
